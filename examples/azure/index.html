<html>
	<head>
		<title>Azure Examples</title>
    <link rel="search" 
      type="application/opensearchdescription+xml" 
      title="MikeAmundsen and friends" 
      href="http://wego-wego.appspot.com/friendfeed/mamund/osd/" />
    <style type="text/css">
        div#page-body
        {
            width:1100px;
            margin: auto;
        }
        h1,h2,h3,h4,p
        {
            margin-bottom:0;
        }
        div.entry p
        {
            margin-bottom:.5em;
        }
        h4
        {
            margin-top:0;
        }
        code
        {
            font-weight:bold;
        }
        .email
        {
            font-weight:bold;
            font-style:italic;
        }
        blockquote
        {
            border:1px solid silver;
            background-color:#e9e9e9;
            padding:.3em;
        }
        .hidden
        {
            display:none;
        }
        .alert
        {
            margin: auto 3em;
            border:1px solid red;
            padding: .2em;
            background-color:#ffc;
        }
        .alert h3,h4,p
        {
            margin:0;
        }
        .notice
        {
            margin: .3em;
            background-color:#e9e9e9;
            padding:.2em;
            border:1px solid black;
        }
        .code
        {
            padding:1em;
            margin: auto 3em;
            border: 1px solid black;
            background-color:silver;
            font-weight:bold;
        }
        .documentation
        {
            margin: auto 3em;
            padding: 1em;
            border: 1px solid black;
            background-color: #ccc;
            font-size: 12px;
            color:black;
        }
    </style>
	</head>
	<body>
	    <div id="page-body">
        <div id="ads" style="text-align:center;">
            <script type="text/javascript">
                <!--
                google_ad_client = "pub-2944238157647009";
                google_ad_width = 728;
                google_ad_height = 90;
                google_ad_format = "728x90_as";
                google_ad_type = "text_image";
                //2007-08-10: hikeweb
                google_ad_channel = "4794860677";
                google_color_border = "000000";
                google_color_bg = "F0F0F0";
                google_color_link = "000000";
                google_color_text = "000000";
                google_color_url = "000000";
                //-->
            </script>
            <script type="text/javascript"
              src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
            </script>
        </div>
		<h1>Azure Examples</h1>
		<h4>Exploring Windows Azure services.</h4>
	    <div id="links">
		    <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="wishlist/index.html">Azure Feature Wishlist</a></li>
                <li><a href="feedback/index.html">Feedback</a></li>
                <li><a href="http://github.com/mamund/azure-examples/tree/master" title="azure-examples">github</a></li>
                <li><a href="http://code.google.com/p/azure-examples/" title="azure-examples">GoogleCode</a></li>
                <li><a href="http://social.msdn.microsoft.com/Forums/en-US/category/azure/" title="Azure @ MSDN Forums">MSDN Forums</a></li>
                <li><a href="http://code.google.com/p/azure-examples/downloads/list" title="Download the code">Download</a></li>
		    </ul>
		</div>
		<div class="alert hidden">
		    <h4>NOTE</h4>
		    <p>
		        On 2008-12-16, this server will undergo extensive maintenance including relocation. The site may be down
		        for 24 hrs or more. Sorry for the nconvenience. I'll have the server back up as quickly as possible. 
		    </p>
		</div>
		<div class="alert" style="display:none">
		    <h4>ATTENTION:</h4>
		    <p>
		        These examples only work if you have a valid Azure Storage project and shared key. If you don't have one, 
		        you can visit the <a href="http://www.microsoft.com/azure/default.mspx" title="Azure Services Platform">Azure</a> web site to request one.
		    </p>
		</div>
		<div class="entry">
		    <h2>Azure.exe - Added support for Table continuation headers</h2>
		    <h4>2008-12-14</h4>
		    <p>
		        It was pointed out that <b>Azure.exe</b> was not honoring the continuation header for Table queries 
		        (<code>x-ms-NextTableName</code>).
		        This has been fixed. I also added several static XML files that are the results of Table and Entity
		        queries for both Feeds and single Entries. These can be used to validate the Azure Atom output 
		        against the <a href="http://validator.w3.org/feed/" title="Check the syntax of Atom or RSS feeds">W3C Atom validator</a>.
		    </p>
		</div>
		<div class="entry">
		    <h2>GoogleCode Source Hosting</h2>
		    <h4>2008-12-13</h4>
		    <p>
		        All the code for my Azure Examples can now be found at <a href="http://azure-examples.googlecode.com/" title="azure-examples">GoogleCode</a>. This is an SVN-based
		        site and is a bit friendlier than the github I've been using for daily check-ins. The GoogleCode site will be
		        updated for each major change and not for each and every daily mod. If you're interested in 'the big picture'
		        releases, this one will get you what you need.
		    </p>
		</div>
		<div class="entry">
		    <h2>Azure.exe - Added support for continuation headers</h2>
		    <h4>2008-12-12</h4>
		    <p>
		        I added support for Azure's "paging" continuation headers. Now, when you execute a query using
		        the <code>$top=<em>n</em></code> argument, <code>Azure.exe</code> will automatically check the
		        response headers and, if the <code>x-ms-contination-NextParitionKey</code> and 
		        <code>x-ms-NextRowkey</code> headers are returned, you'll see a prompt for <kbd>[n]ext or e[x]it</kbd>.
		        This was a pretty simple addition. While I prefer the 
		        <a href="http://tools.ietf.org/rfc/rfc5005.txt" title="Feed Paging and Archiving">paging pattern proposed for Atom</a>, 
		        this one works well for 'forward-only' cursor-style.
		    </p>
		    <blockquote>
		        <h4>NOTE</h4>
		        <p>Thanks goes to <a href="http://blog.smarx.com/" title="Steve Marx works for Microsoft on Windows Azure">Steve Marx</a> for his 
		        <a href="http://blog.smarx.com/posts/paging-over-data-in-windows-azure-tables" title="Paging Over Data in Windows Azure Tables">blog post explaining the continuation header</a>. 
		        I lifted several things from 
		        that post. If the paging works, it's due to his efforts. However, if it fails, it's all my doing [grin].</p>
		    </blockquote>
		</div>
		<div class="entry">
		    <h2>Azure.exe - Command-line app for Table Storage</h2>
		    <h4>2008-12-11</h4>
		    <p>
		        This is a 'full-blown' CLI (command-line interface) for your Azure Table Storage.
		        It supports GET, POST, and DELETE for Tables; GET, POST, PUT, MERGE, and DELETE for
		        Entities; and ad-hoc queries against Entities. It honors ETags and uses them for 
		        successful PUT, MERGE, and DELETE requests against the server stores. Below is
		        the <code>ShowHelp()</code> output that summarizes the syntax:
		    </p>
		    <pre class="documentation">
Tables:
	/{tid} [[g]et]
	ex: /my-table

	/{tid} [p]ost
	ex: /my-new-table p

Entities:
	/{tid}/ [[g]et]
	ex: /my-table/

	/{tid}/{pid},{rid} [[g]et]
	ex: /my-table/my-partition,my-row

	/{tid}/{pid},{rid} [p]ost "{xml}|{filename}" 
	ex: /my-table/my-partition,myrow p c:\new-properties.xml

	/{tid}/{pid},{rid} p[u]t "{xml|filename}" 
	ex: /my-table/my-partition,my-row u c:\modified-properties.xml

	/{tid}/{pid},{rid} [m]erge "{xml|filename}" 
	ex: /my-table/my-partition,my-row m c:\partial-properties.xml

	/{tid}/{pid},{rid} [d]elete
	ex: /my-table/my-partition,my-row d

Queries:
	/{tid}/? "{query}" [[g]et]
	ex: "?Customers()?$filter=(InvoiceOnFile eq true)&top=10"

		    </pre>
		</div>
		<div class="entry">
    		<h2>AzureTest - Command-line GET utility</h2>
	    	<h4>2008-12-09</h4>
		    <p>
		        This is a simple app that requests data from your Azure Tables account. I built this to
		        validate hashing, handling requests, and sniffing returns for things like continuation
		        headers, ETag caching, etc. It's probably not very interesting unless you want to 
		        dig into it to pull out a few bits for your own use.
            </p>
		</div>
		<div class="entry">
    		<h2>CreateTable - Command-line POST utility</h2>
	    	<h4>2008-1208</h4>
		    <p>
		        My first Azure Tables app. This tiny demo creates a new table in the Azure Table Storage system.
		        This is done using plain old HTTP. No Azure SDKs; No Vista; No Visual Studio 2008; No .NET 3.51.
		        Just .NET 2.0 C# and WebRequest/WebResponse. all just to prove I can, actually.
		    </p>
		    <p>
		        The most interesting code in this demo is stuff that handles MSFT's custom authentication header
		        (<em>boo, hiss</em>). There are several 'flavors' of auth headers for Azure (based on service, 
		        code library, and target (dev or live). This version works for live Azure Table Storage only. It's
		        the one I plan on using most often. See the snippet below and download the code for the whole story.
		    </p>
		    <pre class="code">
// build up azure SharedKey hash
string authValue = string.Format(fmtStringToSign, method, contentMD5, contentType, reqDate, canonicalResource);
string sigValue = ComputeMacSha(authValue, Convert.FromBase64String(authKey));
string authHeader = string.Format(fmtHeader, keyType, account, sigValue);

// hashing helper
private static string ComputeMacSha(string canonicalizedString, byte[] key)
{
  byte[] dataToMAC = System.Text.Encoding.UTF8.GetBytes(canonicalizedString);

  using (HMACSHA256 hmacsha1 = new HMACSHA256(key))
  {
    return System.Convert.ToBase64String(hmacsha1.ComputeHash(dataToMAC));
  }
}
            </pre>
		</div>
	    </div>
		<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
		<script type="text/javascript">
		_uacct = "UA-2399548-1";
		urchinTracker();
		</script>
	</body>
</html>