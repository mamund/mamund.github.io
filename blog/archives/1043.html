<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head profile="http://purl.org/NET/erdf/profile">
    <META http-equiv="Content-Type" content="text/html; charset=utf-16">
    <title>
					mca blog
					
									[RESTful Profiling : XHTML-based Web APIs]
								</title>
    <link rel="alternate" type="application/x-wiki" title="Edit this blog" href="http://amundsen.com/blog/edit/">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for mca blog" href="../feed/index.html">
    <link rel="stylesheet" type="text/css" href="http://amundsen.com/server/conflate/?/xcs/blogging/css/blogging.css,/xcs/blogging/css/blogging-layout.css,/xcs/blogging/css/blogging-iran-election.css">
    <link rel="search" type="application/opensearchdescription+xml" title="MikeAmundsen and friends" href="http://wego-wego.appspot.com/friendfeed/mamund/osd/">
    <link rel="schema.rdfs" href="http://www.w3.org/2000/01/rdf-schema#">
    <link rel="schema.dc" href="http://purl.org/dc/elements/1.1/">
    <link rel="schema.foaf" href="http://xmlns.com/foaf/0.1/">
    <link rel="schema.bio" href="http://vocab.org/bio/0.1/">
    <link rel="schema.contact" href="http://www.w3.org/2000/10/swap/pim/contact#">
    <link rel="schema.air" href="http://www.daml.org/2001/10/html/airport-ont#">
    <link rel="schema.wn" href="http://xmlns.com/wordnet/1.6/">
    <link rel="schema.rss" href="http://purl.org/rss/1.0/">
    <link rel="schema.terms" href="http://purl.org/dc/terms/">
    <link rel="schema.rel" href="http://purl.org/vocab/relationship/">
    <link rel="schema.geo" href="http://www.w3.org/2003/01/geo/wgs84_pos#">
    <link rel="schema.aff" href="http://purl.org/vocab/affiliations/0.1/">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <link rel="schema.org" href="http://purl.org/vocab/organizations/0.1/">
    <link rel="schema.psych" href="http://purl.org/vocab/psychometric-profile/">
    <link rel="schema.doap" href="http://usefulinc.com/ns/doap#">
    <style type="text/css">
					form
					{
					font-size:small;
					padding:.3em;
					text-align:center;
					}
					input
					{
					font-size:x-small;
					}
					#twitter_div
					{
					/*
					width:95%
					padding:.2em;
					border:1px solid black;
					*/
					}
					#twitter_div h2
					{
					margin:0;
					padding:0;
					float:right;
					}
					.twitter-title
					{

					}
					#twitter_update_list
					{
					font-family:monospace;
					list-style:none;
					margin:0;
					padding:0;
					float:none;
					clear:both;
					}
					#twitter_update_list li
					{
					border:1px solid silver;
					background-color:#e6e6e6;
					margin:.2em .2em;
					}
					.twitter-link
					{
					display:block;
					float:right;
					margin-right: .7em;
					}
					#twitter_div a
					{
					text-decoration:none;
					}
					#twitter_div a:hover
					{
					text-decoration:underline;
					}
					.empty
					{
					float:none;
					clear:both;
					visibility:hidden;
					margin:0;
					padding:0;
					}
				</style><script type="text/javascript" src="http://amundsen.com/server/conflate/?/xcs/blogging/scripts/blogging.js,/lib/jscap/jcap.js,/lib/jscap/md5.js">//</script></head>
  <body>
    <div id="wrap">
      <div id="header">
        <h1><a href="../index.html" title="home page">mca blog</a></h1>
        <p class="title-desc">life in lowercase</p>
      </div>
      <div id="nav">
        <ul>
          <li><a href="../index.html" title="home page">Home</a></li>
          <li><a href="../categories/index.html" title="blog categories">Categories</a></li>
          <li><a href="../websites/index.html" title="intersting web sites">Web Sites</a></li>
          <li><a href="index.html" title="browse the archives">Archives</a></li>
        </ul>
      </div>
      <div id="main">
        <h2 class="dc-title">RESTful Profiling : XHTML-based Web APIs</h2>
        <div class="weblog">
          <div class="wb-header"><span class="foaf-maker" style="display:none;"><a href="http://www.amundsen.com/blog/author/mamund" title="Posted by mamund">mamund</a></span><span class="logdate" style="margin-left:1em;">2010-04-19 @ 13:59</span><span class="permalink"><a href="1043.html" title="perma-link">#</a></span></div>
          <div class="dc-description"><blockquote>
  <b>NOTE</b><br />
  this is another post in my 
  <a href="1041.html" title="A RESTful Hypermedia API in Three Easy Steps">ongoing</a> 
  <a href="1042.html" title="Modified RPC over HTTP: old wine in a new bottle">series</a> about 
  <a href="1039.html" title="The H Factor for Media Types">hypermedia</a>, and 
  <a href="1040.html" title="not all Web APIs are the same">Web API</a> design.
</blockquote>

<p>
  <a href="http://www.flickr.com/photos/nuanc/64235415/" title="colored pencil collection">
    <img src="http://farm1.static.flickr.com/25/64235415_6f10ab1519_t.jpg" align="right" class="inline" />
  </a>
  When designing your hypermedia Web API, you don't always have to use a custom media-type to express your
  data and linking semantics. Instead you can use a well-known, 
  <a href="http://www.iana.org/assignments/media-types/" title="MIME Media Types">registered</a> media-type.
  the advantage of registered media-types is that they are more likely to be understood and rendered properly
  by common Web browsers and other existing generic clients. the disadvantage of using registered types is that
  they usually lack the specific semantics you need for your service or application. that means you need to 
  <i>extend</i> the registered type in a way that clients can understand. this process of extending is usually
  handled differently for each media-type.
</p>
<h4>XHTML as your Hypermedia API media-type</h4>
<p>
  <a href="http://www.w3.org/TR/2001/REC-xhtml11-20010531/" title="XHTML™ 1.1 - Module-based XHTML">XHTML</a> 
  is a very powerful media-type and can be easily extended to include your specific data and link semantics.
  XHTML's link elements (<code>A</code> tags) support the <code>REL</code> attribute and <code>FORM</code> elements support the
  <code>NAME</code> attribute. these can attributes be used to mark the application flow semantics for your Web API.
  you can provide query and write templates using the <code>FORM</code> and <code>INPUT</code> elements. 
</p>
<p>
  as is the case for most all general media types, some compromises need to be made when you adopt the type for your
  specific needs. for example, XHTML only defines <code>POST</code> and <code>GET</code> as valid values for the 
  <code>METHOD</code> attribute of <code>FORM</code> elements. while HTML5 will soon support <code>DELETE</code> and <code>PUT</code>
  values for the <code>METHOD</code> attribute, current implementations using X/HTML will need to deal with this limitation by either sending 
  <a href="http://github.com/mamund/http-samples/blob/master/root/files/js/to-do.js" title="HTTP-Samples TO-DO.JS">additional code-on-demand</a> 
  to common browsers (my preferred approach) or re-design the client-server interactions to support only 
  <code>POST</code> and <code>GET</code>. note that for cases wherer your Web API is used only with custom-built clients 
  (bots, desktop applications, RIAs, etc.), this <code>METHOD</code> attribute value limitation likely can be ignored.
</p>
<h4>List Service Redux</h4>
<p>
  using the same general web service i outlined in a 
  <a href="1041.html" title="A RESTful Hypermedia API in Three Easy Steps">previous post</a>, 
  here's one way to implement the List Service using XHTML as the hypermedia type:
</p>
<pre class="code">
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"&gt; 
  &lt;head&gt; 
    &lt;title&gt;List Service&lt;/title&gt; 
  &lt;/head&gt; 
  &lt;body&gt; 
    &lt;div class="list"&gt;
      &lt;!-- list collection --&gt;
      &lt;dl&gt;
        &lt;dt&gt;
          &lt;a href="{item-uri}" rel="item" title="item"&gt;{item-uri}&lt;/a&gt;
        &lt;/dt&gt;
        &lt;dd&gt;
          &lt;span class="title"&gt;First Task&lt;/span&gt;
          &lt;span class="description"&gt;Produce first draft of Task media-type&lt;/span&gt;
          &lt;span class="date-due"&gt;2010-04-21&lt;/span&gt;
          &lt;span class="completed"&gt;false&lt;/span&gt;
        &lt;/dd&gt;
        &lt;dt&gt;
          &lt;a href="{item-uri}" rel="item" title="item"&gt;{item-uri}&lt;/a&gt;
        &lt;/dt&gt;
        &lt;dd&gt;
          &lt;span class="title"&gt;Second Task&lt;/span&gt;
          &lt;span class="description"&gt;Implement REST version of Task Service over HTTP&lt;/span&gt;
          &lt;span class="date-due"&gt;2010-04-23&lt;/span&gt;
          &lt;span class="completed"&gt;false&lt;/span&gt;
        &lt;/dd&gt;
        &lt;dt&gt;
          &lt;a href="{item-uri}" rel="item" title="item"&gt;{item-uri}&lt;/a&gt;
        &lt;/dt&gt;
        &lt;dd&gt;
          &lt;span class="title"&gt;Next&lt;/span&gt;
          &lt;span class="description"&gt;Go hiking&lt;/span&gt;
          &lt;span class="date-due"&gt;2010-04-23&lt;/span&gt;
          &lt;span class="completed"&gt;false&lt;/span&gt;
        &lt;/dd&gt;
      &lt;/dl&gt;
      &lt;!-- adding a new item --&gt;
      &lt;form name="add" method="post" action="{collection-uri}"&gt;
        &lt;input type="text" name="title" /&gt;
        &lt;input type="text" name="description" /&gt;
        &lt;input type="text" name="date-due" /&gt;
        &lt;input type="text" name="completed" /&gt;
        &lt;input type="submit" value="add" /&gt;
      &lt;/form&gt;
      &lt;!-- item update &amp; delete --&gt;
      &lt;form name="edit" method="put" action="{item-uri}"&gt;
        &lt;input type="text" name="title" /&gt;
        &lt;input type="text" name="description" /&gt;
        &lt;input type="text" name="date-due" /&gt;
        &lt;input type="text" name="completed" /&gt;
        &lt;input type="submit" value="edit" /&gt;
      &lt;/form&gt;
      &lt;form name="delete" method="delete" action="{item-uri}"&gt;
        &lt;input type="submit" value="delete" /&gt;
      &lt;/form&gt;    
      &lt;!-- queries --&gt;
      &lt;form name="today" method="get" action="{today-query-uri}"&gt;
        &lt;input type="submit" value="today" /&gt;
      &lt;/form&gt;
      &lt;form name="open" method="get" action="{open-query-uri}"&gt;
        &lt;input type="submit" value="open" /&gt;
      &lt;/form&gt;
      &lt;form name="date-range" method="get" action="{date-range-query-uri}"&gt;
        &lt;input type="text" name="date-start" /&gt;
        &lt;input type="text" name="date-stop" /&gt;
        &lt;input type="submit" value="date-range" /&gt;
      &lt;/form&gt;
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>
<p>
  you'll note that the XML elements for the list that appeared in my custom media type example now appear as XHTML's
  <code>DL</code>, <code>DT</code>, and <code>DD</code> elements. the individual data elements within an item are expressed as 
  <code>SPAN</code>s. note also that i've used the <code>CLASS</code> attribute to provide the 
  "meaning" of each of the important data elements. this is similar to the 
  <a href="http://microformats.org/" title="microformats">Microformat</a> approach to adding semantic meaning to HTML content.
</p>
<p>
  the query and write operations are expressed using <code>FORM</code> elements and <code>INPUT</code> elements where appropriate.
  i use <code>DELETE</code> and <code>PUT</code> as values for the <code>METHOD</code> attribute here even though i know that 
  common browsers that don't support HTML5 will ignore these values (actually convert them to <code>GET</code>). i can handle 
  this limitation using code-on-demand for javascript, if necessary.
</p>
<p>
  this rounds out the extension of XHTML to handle the semantic requirements of my simple List Service. all that's left is to  
  make sure both clients and servers <i>recognize</i> and <i>understand</i> these semantic extentions.
</p>
<h4>but how do i *know* what you mean?</h4>
<p>
  when using extended media types, it is not easy for clients or servers to know (ahead of time) the nature of those additional 
  data and link semantics. custom media-types carry this information in the media-type name and the associated documentation.  
  using a general media-type makes expressing the semantics more difficult. one possibility is to modify the media-type name 
  itself (<code>text/html;type=list-manager</code>, but this has problems, too.
</p>
<p>
  luckily, XHTML already has a very handy way to convey the semantics of the document: the <code>PROFILE</code> attribute.
</p>
<h4>using XHTML Profiles to express media semantics</h4>
<p>
  HTML defines the <a href="http://www.w3.org/TR/html401/struct/global.html#h-7.4.4.3" title="Meta data profiles"><code>PROFILE</code> attribute</a> 
  for <code>HEAD</code> and <code>META</code> elements as a way to include additional information about the contents of the HTML document.
  you can use this attribute as a way to indicate the semantic details of the response. IOW, the profile can act in the same way a custom 
  media-type name does. here's an example:
</p>
<pre class="code">
&lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"&gt; 
  <b>&lt;head profile="http://www.example.org/profiles/list-manager" &gt;</b>
    &lt;title&gt;List Service&lt;/title&gt; 
  &lt;/head&gt; 
  ...
  ** OR **
&lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"&gt; 
  &lt;head&gt; 
    &lt;title&gt;List Service&lt;/title&gt; 
    <b>&lt;meta name="profile" href="http://www.example.org/profiles/list-manager" /&gt;</b>
  &lt;/head&gt; 
  ...

</pre>
<p>
  in cases where the HTTP protocol is used, this profile URI can be added as control data using a 
  <a href="http://tools.ietf.org/html/draft-nottingham-http-link-header-09" title="Web Linking

">Link Header</a>:
</p>
<pre class="code">
  REQUEST ***
  GET /lists/my-list HTTP/1.1
  Host: www.example.org
  Accept: application/xhtml+xml
  
  RESPONSE ***
  HTTP/1.1 200 OK 
  <b>Link: &lt;http://www.example.org/profiles/list-manager&gt;;rel="profile"</b>
  Content-Type: application/xhtml+xml 
  Content-Length: xxx
  ...
</pre>
<p>
  when handling the response, clients can inspect the <code>PROFILE</code> attribute (or link header) to confirm the semantics of the 
  content. if the client does not recognize the profile, it can choose to ignore it (as the common browser does) or reject the document 
  as unknown (the same way browsers act when they see a media-type they do not understand). 
</p>
<p>
  as is indicated in the spec, the profile attribute can be treated as a reference URI (a simple id) or as a resolvable URI that points 
  to another document with details on the profile. i use the second approach and place a resource at the other end of the URI that documents 
  the semantic details in a way similar to that of a registered custom media type. i use 
  <a href="http://tantek.com/" title="Tantek Çelik">Tantek Çelik</a>'s very nice example of how to document 
  <a href="http://gmpg.org/xmdp/description" title="Xhtml Meta Data Profiles">HTML profiles</a>. 
</p>
<h4>bottom line</h4>
<p>
  if you do not want to create your own custom media-type, you can adopt an existing, registered type and extend it with your service's
  specific data and link semantics. for me, XHTML is the  best choice for an "extensible" hypermedia type. it contains most of the 
  link elements a Web API needs (<code>A</code>, <code>FORM</code>, and <code>INPUT</code>) and, if you adopt the Microformat model 
  for markup up your XHTML-based Web APIs, you can probably the same responses for both common browsers and targeted clients 
  (bots, desktop apps, RIAs, etc.). 
</p>
<p>
  <i>btw, are you wondering why i did not select <a href="http://www.ietf.org/rfc/rfc4287.txt" title="The Atom Syndication Format">Atom</a> 
as my "go-to" registered media-type for Web API design? maybe i'll cover that next week.</i>
</p>
</div>
          <p class="category"><a href="index.html%3Fcategory=22.html" title="more from REST...">REST</a></p>
          <hr><a id="comments"></a><script>
						var idcomments_acct = 'b941b488f39712a0d6409992a0d7fc47';
						var idcomments_post_id;
						var idcomments_post_url;
					</script><span id="IDCommentsPostTitle" style="display:none"></span><script type="text/javascript" src="http://www.intensedebate.com/js/genericCommentWrapperV2.js"></script></div>
        <div> </div>
      </div>
      <div id="sidebar">
        <h4>categories</h4>
        <ul>
          <li><a href="index.html%3Fcategory=33.html">Systems</a></li>
          <li><a href="index.html%3Fcategory=32.html">CA</a></li>
          <li><a href="index.html%3Fcategory=31.html">IoT</a></li>
          <li><a href="index.html%3Fcategory=30.html">ALPS</a></li>
          <li><a href="index.html%3Fcategory=29.html">API</a></li>
          <li>[<a href="../categories/index.html%3Fall.html" title="view all categories">all</a>]</li>
        </ul>
        <h4>websites</h4>
        <ul>
          <li><a href="../websites/32.html">Untangled</a></li>
          <li><a href="../websites/31.html">Anne’s Weblog</a></li>
          <li><a href="../websites/30.html">exyus</a></li>
          <li><a href="../websites/29.html">Random Stuff</a></li>
          <li><a href="../websites/28.html">JScript Blog</a></li>
          <li>[<a href="../websites/index.html%3Fall.html" title="view all websites">all</a>]</li>
        </ul>
        <h4>archives</h4>
        <ul>
          <li><a href="index.html%3Ftoday.html" title="today's posts">today</a></li>
          <li><a href="index.html%3Fyesterday.html" title="yesterday's posts">yesterday</a></li>
          <li><a href="index.html%3Fthisweek.html" title="this weeks's posts">this week</a></li>
          <li><a href="index.html%3Flastweek.html" title="last week's posts">last week</a></li>
          <li><a href="index.html%3Fthismonth.html" title="this month's posts">this month</a></li>
          <li><a href="index.html%3Flastmonth.html" title="last month's posts">last month</a></li>
          <li>
								[<a href="index.html" title="browse the archives">browse</a>]
							</li>
        </ul>
        <div> </div>
        <div><xscript type="text/javascript" src="http://plancast.com/goodies/widgets/sidebar/1/15731">// plancast</xscript></div>
        <div id="twitter_div">
          <h4>my tweets</h4>
          <ul id="twitter_update_list"></ul>
          <div class="twitter-link"><a href="http://twitter.com/mamund" title="follow me on Twitter">
									follow me
								</a></div>
          <hr class="empty">
        </div>
      </div>
      <div id="ads" style="text-align:center;"><script type="text/javascript">
							google_ad_client = "pub-2944238157647009";
							google_ad_width = 728;
							google_ad_height = 90;
							google_ad_format = "728x90_as";
							google_ad_type = "text";
							//2007-08-10: amundsen.com
							google_ad_channel = "2960096544";
							google_color_border = "000000";
							google_color_bg = "F0F0F0";
							google_color_link = "000000";
							google_color_text = "000000";
							google_color_url = "000000";
						</script><script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script></div>
      <div id="footer">
        <p>Copyright © 2007-2010 amundsen.com, inc. All rights reserved.</p>
      </div>
    </div><script type="text/javascript" src="http://twitter.com/javascripts/blogger.js"></script><script type="text/javascript" src="http://twitter.com/statuses/user_timeline/mamund.json?callback=twitterCallback2&amp;count=5"></script><script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
					_uacct = "UA-2399548-1";
					urchinTracker();
				</script></body>
</html>