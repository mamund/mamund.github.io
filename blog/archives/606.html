<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head profile="http://purl.org/NET/erdf/profile">
    <META http-equiv="Content-Type" content="text/html; charset=utf-16">
    <title>
					mca blog
					
									[JSON-to-XML - harder stuff]
								</title>
    <link rel="alternate" type="application/x-wiki" title="Edit this blog" href="http://amundsen.com/blog/edit/">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for mca blog" href="../feed/index.html">
    <link rel="stylesheet" type="text/css" href="http://amundsen.com/server/conflate/?/xcs/blogging/css/blogging.css,/xcs/blogging/css/blogging-layout.css,/xcs/blogging/css/blogging-iran-election.css">
    <link rel="search" type="application/opensearchdescription+xml" title="MikeAmundsen and friends" href="http://wego-wego.appspot.com/friendfeed/mamund/osd/">
    <link rel="schema.rdfs" href="http://www.w3.org/2000/01/rdf-schema#">
    <link rel="schema.dc" href="http://purl.org/dc/elements/1.1/">
    <link rel="schema.foaf" href="http://xmlns.com/foaf/0.1/">
    <link rel="schema.bio" href="http://vocab.org/bio/0.1/">
    <link rel="schema.contact" href="http://www.w3.org/2000/10/swap/pim/contact#">
    <link rel="schema.air" href="http://www.daml.org/2001/10/html/airport-ont#">
    <link rel="schema.wn" href="http://xmlns.com/wordnet/1.6/">
    <link rel="schema.rss" href="http://purl.org/rss/1.0/">
    <link rel="schema.terms" href="http://purl.org/dc/terms/">
    <link rel="schema.rel" href="http://purl.org/vocab/relationship/">
    <link rel="schema.geo" href="http://www.w3.org/2003/01/geo/wgs84_pos#">
    <link rel="schema.aff" href="http://purl.org/vocab/affiliations/0.1/">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <link rel="schema.org" href="http://purl.org/vocab/organizations/0.1/">
    <link rel="schema.psych" href="http://purl.org/vocab/psychometric-profile/">
    <link rel="schema.doap" href="http://usefulinc.com/ns/doap#">
    <style type="text/css">
					form
					{
					font-size:small;
					padding:.3em;
					text-align:center;
					}
					input
					{
					font-size:x-small;
					}
					#twitter_div
					{
					/*
					width:95%
					padding:.2em;
					border:1px solid black;
					*/
					}
					#twitter_div h2
					{
					margin:0;
					padding:0;
					float:right;
					}
					.twitter-title
					{

					}
					#twitter_update_list
					{
					font-family:monospace;
					list-style:none;
					margin:0;
					padding:0;
					float:none;
					clear:both;
					}
					#twitter_update_list li
					{
					border:1px solid silver;
					background-color:#e6e6e6;
					margin:.2em .2em;
					}
					.twitter-link
					{
					display:block;
					float:right;
					margin-right: .7em;
					}
					#twitter_div a
					{
					text-decoration:none;
					}
					#twitter_div a:hover
					{
					text-decoration:underline;
					}
					.empty
					{
					float:none;
					clear:both;
					visibility:hidden;
					margin:0;
					padding:0;
					}
				</style><script type="text/javascript" src="http://amundsen.com/server/conflate/?/xcs/blogging/scripts/blogging.js,/lib/jscap/jcap.js,/lib/jscap/md5.js">//</script></head>
  <body>
    <div id="wrap">
      <div id="header">
        <h1><a href="../index.html" title="home page">mca blog</a></h1>
        <p class="title-desc">life in lowercase</p>
      </div>
      <div id="nav">
        <ul>
          <li><a href="../index.html" title="home page">Home</a></li>
          <li><a href="../categories/index.html" title="blog categories">Categories</a></li>
          <li><a href="../websites/index.html" title="intersting web sites">Web Sites</a></li>
          <li><a href="index.html" title="browse the archives">Archives</a></li>
        </ul>
      </div>
      <div id="main">
        <h2 class="dc-title">JSON-to-XML - harder stuff</h2>
        <div class="weblog">
          <div class="wb-header"><span class="foaf-maker" style="display:none;"><a href="http://www.amundsen.com/blog/author/mamund" title="Posted by mamund">mamund</a></span><span class="logdate" style="margin-left:1em;">2008-02-02 @ 08:57</span><span class="permalink"><a href="606.html" title="perma-link">#</a></span></div>
          <div class="dc-description"><p>i continue to beat up  my JSON-to-XML service today. as i mentioned in my <a href="605.html" title="JSON-to-XML - dead simple">previous post</a>, i'm building this service so that i can consistently convert incoming JSON strings (from <code>PUT/POST</code> into a valid XML document. that's because my <a href="http://exyus.com" title="exyus">exyus</a> engine uses XML documents to validate (via XSD) and transform (via XSLT) data into whatever representation(s) i need. so this is all about utility and consistency.</p>
<p>anyway, here's a couple other examples of output from my utility. first, a JSON string that contains and array *and* at least one name that is an invalid XML name (due to use of namespace):</p>
<pre class="code">
{'tasks' :
{ 'xml:base':'http://localhost/xcs/tasklist/',
'task' : [
{'id' : 'x8ca2f68ed5464b2', 'seq' : '1', 'name' : 'Read Mike\'s TaskList Tutorial', 'is-completed' : '1'}
,
{'id' : 'x8ca2f68f058de9a', 'seq' : '2', 'name' : 'Download Exyus', 'is-completed' : '0'}
,
{'id' : 'x8ca2f68f623d546', 'seq' : '3', 'name' : 'Install and run examples', 'is-completed' : '0'}
,
{'id' : 'x8ca2f690144ef64', 'seq' : '4', 'name' : 'Use Exyus to build my own cool app', 'is-completed' : '0'}
]
}
}

&lt;root&gt;
  &lt;tasks&gt;
    &lt;task&gt;
      &lt;item&gt;
        &lt;is-completed&gt;1&lt;/is-completed&gt; 
        &lt;name&gt;Read Mike's TaskList Tutorial&lt;/name&gt; 
        &lt;seq&gt;1&lt;/seq&gt; 
        &lt;id&gt;x8ca2f68ed5464b2&lt;/id&gt; 
      &lt;/item&gt;
      &lt;item&gt;
        &lt;is-completed&gt;0&lt;/is-completed&gt; 
        &lt;name&gt;Download Exyus&lt;/name&gt; 
        &lt;seq&gt;2&lt;/seq&gt; 
        &lt;id&gt;x8ca2f68f058de9a&lt;/id&gt; 
      &lt;/item&gt;
      &lt;item&gt;
        &lt;is-completed&gt;0&lt;/is-completed&gt; 
        &lt;name&gt;Install and run examples&lt;/name&gt; 
        &lt;seq&gt;3&lt;/seq&gt; 
        &lt;id&gt;x8ca2f68f623d546&lt;/id&gt; 
      &lt;/item&gt;
      &lt;item&gt;
        &lt;is-completed&gt;0&lt;/is-completed&gt; 
        &lt;name&gt;Use Exyus to build my own cool app&lt;/name&gt; 
        &lt;seq&gt;4&lt;/seq&gt; 
        &lt;id&gt;x8ca2f690144ef64&lt;/id&gt; 
      &lt;/item&gt;
    &lt;/task&gt;
    &lt;xml_base&gt;http://localhost/xcs/tasklist/&lt;/xml_base&gt; 
  &lt;/tasks&gt;
&lt;/root&gt;
</pre>
<p>not bad. notice the use of the <code>item</code> elements for each member of an array. this is a bit of 'cruft', but it makes logical sense and eases the recursion work i need to do to interpret the JSON string. also note that the incoming <code>"xml:base"</code> has been converted to <code>"xml_base"</code>. technically, this is not an invalid XML element name, but i have way to easily sort out XML namespaces in JSON strings[!] so i just convert it.</p>
<p>ok, now how about something a bit more challenging. this is an extensive example i found while researching the rules for JSON serialization. check this out:</p>
<pre class="code">
{
    "this test"  : true,
    "ThreeDSort" : {
        z : 9.323
    },
    "x y" : "x y",
    yPos  : {
        "inner"  : [2,4],
        "outer"  : [4,8,4,8]
    },
    "props": [ true, null, false],
    "oldVals": [ "oldvals1", {innermost:"old+inner"}, "oldvals3"],
    y1   : {
        z  : "value"
    },
    "xy and z": "xy and z",
    y3   : {
        z2  : "z2"
    }
};

&lt;root&gt;
  &lt;xy_x0020_and_x0020_z&gt;xy and z&lt;/xy_x0020_and_x0020_z&gt; 
  &lt;ThreeDSort&gt;
    &lt;z&gt;9.323&lt;/z&gt; 
  &lt;/ThreeDSort&gt;
  &lt;props&gt;
    &lt;item&gt;True&lt;/item&gt; 
    &lt;item&gt;null&lt;/item&gt; 
    &lt;item&gt;False&lt;/item&gt; 
  &lt;/props&gt;
  &lt;x_x0020_y&gt;x y&lt;/x_x0020_y&gt; 
  &lt;oldVals&gt;
    &lt;item&gt;oldvals1&lt;/item&gt; 
    &lt;item&gt;
      &lt;innermost&gt;old+inner&lt;/innermost&gt; 
    &lt;/item&gt;
    &lt;item&gt;oldvals3&lt;/item&gt; 
  &lt;/oldVals&gt;
  &lt;this_x0020_test&gt;true&lt;/this_x0020_test&gt; 
  &lt;y3&gt;
    &lt;z2&gt;z2&lt;/z2&gt; 
  &lt;/y3&gt;
  &lt;yPos&gt;
    &lt;outer&gt;
      &lt;item&gt;4&lt;/item&gt; 
      &lt;item&gt;8&lt;/item&gt; 
      &lt;item&gt;4&lt;/item&gt; 
      &lt;item&gt;8&lt;/item&gt; 
    &lt;/outer&gt;
    &lt;inner&gt;
      &lt;item&gt;2&lt;/item&gt; 
      &lt;item&gt;4&lt;/item&gt; 
    &lt;/inner&gt;
  &lt;/yPos&gt;
  &lt;y1&gt;
    &lt;z&gt;'f'f''&lt;/z&gt; 
  &lt;/y1&gt;
&lt;/root&gt;
</pre>
<p>wow! lots going on there. note the conversion of invalid XML names using the standard XML method of 'escaping' the invalid characters w/ unicode hex. not pretty but standard and safe. lots of nesting; several arrays, etc. mind you, this is 'scary' XML, but it's valid. that's my goal.</p>
<p>i am finishing up the testing and code clean up today. i'll post the bits into the <a href="http://exyus.googlecode.com" title="exyus googlecode">exyus googlecode</a> this weekend. and i should have support for incoming JSON before the start of next week.</p>
</div>
          <p class="category"><a href="index.html%3Fcategory=5.html" title="more from code...">code</a></p>
          <hr><a id="comments"></a><script>
						var idcomments_acct = 'b941b488f39712a0d6409992a0d7fc47';
						var idcomments_post_id;
						var idcomments_post_url;
					</script><span id="IDCommentsPostTitle" style="display:none"></span><script type="text/javascript" src="http://www.intensedebate.com/js/genericCommentWrapperV2.js"></script></div>
        <div> </div>
      </div>
      <div id="sidebar">
        <h4>categories</h4>
        <ul>
          <li><a href="index.html%3Fcategory=33.html">Systems</a></li>
          <li><a href="index.html%3Fcategory=32.html">CA</a></li>
          <li><a href="index.html%3Fcategory=31.html">IoT</a></li>
          <li><a href="index.html%3Fcategory=30.html">ALPS</a></li>
          <li><a href="index.html%3Fcategory=29.html">API</a></li>
          <li>[<a href="../categories/index.html%3Fall.html" title="view all categories">all</a>]</li>
        </ul>
        <h4>websites</h4>
        <ul>
          <li><a href="../websites/32.html">Untangled</a></li>
          <li><a href="../websites/31.html">Anne’s Weblog</a></li>
          <li><a href="../websites/30.html">exyus</a></li>
          <li><a href="../websites/29.html">Random Stuff</a></li>
          <li><a href="../websites/28.html">JScript Blog</a></li>
          <li>[<a href="../websites/index.html%3Fall.html" title="view all websites">all</a>]</li>
        </ul>
        <h4>archives</h4>
        <ul>
          <li><a href="index.html%3Ftoday.html" title="today's posts">today</a></li>
          <li><a href="index.html%3Fyesterday.html" title="yesterday's posts">yesterday</a></li>
          <li><a href="index.html%3Fthisweek.html" title="this weeks's posts">this week</a></li>
          <li><a href="index.html%3Flastweek.html" title="last week's posts">last week</a></li>
          <li><a href="index.html%3Fthismonth.html" title="this month's posts">this month</a></li>
          <li><a href="index.html%3Flastmonth.html" title="last month's posts">last month</a></li>
          <li>
								[<a href="index.html" title="browse the archives">browse</a>]
							</li>
        </ul>
        <div> </div>
        <div><xscript type="text/javascript" src="http://plancast.com/goodies/widgets/sidebar/1/15731">// plancast</xscript></div>
        <div id="twitter_div">
          <h4>my tweets</h4>
          <ul id="twitter_update_list"></ul>
          <div class="twitter-link"><a href="http://twitter.com/mamund" title="follow me on Twitter">
									follow me
								</a></div>
          <hr class="empty">
        </div>
      </div>
      <div id="ads" style="text-align:center;"><script type="text/javascript">
							google_ad_client = "pub-2944238157647009";
							google_ad_width = 728;
							google_ad_height = 90;
							google_ad_format = "728x90_as";
							google_ad_type = "text";
							//2007-08-10: amundsen.com
							google_ad_channel = "2960096544";
							google_color_border = "000000";
							google_color_bg = "F0F0F0";
							google_color_link = "000000";
							google_color_text = "000000";
							google_color_url = "000000";
						</script><script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script></div>
      <div id="footer">
        <p>Copyright © 2007-2010 amundsen.com, inc. All rights reserved.</p>
      </div>
    </div><script type="text/javascript" src="http://twitter.com/javascripts/blogger.js"></script><script type="text/javascript" src="http://twitter.com/statuses/user_timeline/mamund.json?callback=twitterCallback2&amp;count=5"></script><script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
					_uacct = "UA-2399548-1";
					urchinTracker();
				</script></body>
</html>