<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head profile="http://purl.org/NET/erdf/profile">
    <META http-equiv="Content-Type" content="text/html; charset=utf-16">
    <title>
					mca blog
					
									[dropping Maslow's hammer]
								</title>
    <link rel="alternate" type="application/x-wiki" title="Edit this blog" href="http://amundsen.com/blog/edit/">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for mca blog" href="../feed/index.html">
    <link rel="stylesheet" type="text/css" href="http://amundsen.com/server/conflate/?/xcs/blogging/css/blogging.css,/xcs/blogging/css/blogging-layout.css,/xcs/blogging/css/blogging-iran-election.css">
    <link rel="search" type="application/opensearchdescription+xml" title="MikeAmundsen and friends" href="http://wego-wego.appspot.com/friendfeed/mamund/osd/">
    <link rel="schema.rdfs" href="http://www.w3.org/2000/01/rdf-schema#">
    <link rel="schema.dc" href="http://purl.org/dc/elements/1.1/">
    <link rel="schema.foaf" href="http://xmlns.com/foaf/0.1/">
    <link rel="schema.bio" href="http://vocab.org/bio/0.1/">
    <link rel="schema.contact" href="http://www.w3.org/2000/10/swap/pim/contact#">
    <link rel="schema.air" href="http://www.daml.org/2001/10/html/airport-ont#">
    <link rel="schema.wn" href="http://xmlns.com/wordnet/1.6/">
    <link rel="schema.rss" href="http://purl.org/rss/1.0/">
    <link rel="schema.terms" href="http://purl.org/dc/terms/">
    <link rel="schema.rel" href="http://purl.org/vocab/relationship/">
    <link rel="schema.geo" href="http://www.w3.org/2003/01/geo/wgs84_pos#">
    <link rel="schema.aff" href="http://purl.org/vocab/affiliations/0.1/">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <link rel="schema.org" href="http://purl.org/vocab/organizations/0.1/">
    <link rel="schema.psych" href="http://purl.org/vocab/psychometric-profile/">
    <link rel="schema.doap" href="http://usefulinc.com/ns/doap#">
    <style type="text/css">
					form
					{
					font-size:small;
					padding:.3em;
					text-align:center;
					}
					input
					{
					font-size:x-small;
					}
					#twitter_div
					{
					/*
					width:95%
					padding:.2em;
					border:1px solid black;
					*/
					}
					#twitter_div h2
					{
					margin:0;
					padding:0;
					float:right;
					}
					.twitter-title
					{

					}
					#twitter_update_list
					{
					font-family:monospace;
					list-style:none;
					margin:0;
					padding:0;
					float:none;
					clear:both;
					}
					#twitter_update_list li
					{
					border:1px solid silver;
					background-color:#e6e6e6;
					margin:.2em .2em;
					}
					.twitter-link
					{
					display:block;
					float:right;
					margin-right: .7em;
					}
					#twitter_div a
					{
					text-decoration:none;
					}
					#twitter_div a:hover
					{
					text-decoration:underline;
					}
					.empty
					{
					float:none;
					clear:both;
					visibility:hidden;
					margin:0;
					padding:0;
					}
				</style><script type="text/javascript" src="http://amundsen.com/server/conflate/?/xcs/blogging/scripts/blogging.js,/lib/jscap/jcap.js,/lib/jscap/md5.js">//</script></head>
  <body>
    <div id="wrap">
      <div id="header">
        <h1><a href="../index.html" title="home page">mca blog</a></h1>
        <p class="title-desc">life in lowercase</p>
      </div>
      <div id="nav">
        <ul>
          <li><a href="../index.html" title="home page">Home</a></li>
          <li><a href="../categories/index.html" title="blog categories">Categories</a></li>
          <li><a href="../websites/index.html" title="intersting web sites">Web Sites</a></li>
          <li><a href="index.html" title="browse the archives">Archives</a></li>
        </ul>
      </div>
      <div id="main">
        <h2 class="dc-title">dropping Maslow's hammer</h2>
        <div class="weblog">
          <div class="wb-header"><span class="foaf-maker" style="display:none;"><a href="http://www.amundsen.com/blog/author/mamund" title="Posted by mamund">mamund</a></span><span class="logdate" style="margin-left:1em;">2011-04-05 @ 08:38</span><span class="permalink"><a href="1097.html" title="perma-link">#</a></span></div>
          <div class="dc-description"><p>
<a href="http://www.flickr.com/photos/simonewalsh/4652237704/" title="The hammer of doom">
	<img src="http://farm5.static.flickr.com/4004/4652237704_4cee82ab57_t.jpg" align="right" class="inline" />
</a>
i think i see this question (in some form or another) almost once a week. in forums, online chats,
blogs, in real-life, etc.
</p>
<blockquote>
	"For anyone using JSON-based media types, are you passing around a '__type' property in order to 
	deserialize? If not, how do you parse the JSON (i'm working in .net here)"
</blockquote>
<p>
first, this is <b>not</b> a silly question. in fact, the second sentence goes to the heart of it:
</p>
<blockquote>
	"If [you don't use a 'type' property], how do you parse the [payload]?"
</blockquote>
<p>
and here is one of the real <i>gotcha's</i> of distributed network programming: type-system problems.
there are several common ways to try to solve this seemingly unsolvable problem. let's look at some
of the persistent attempts:
</p>
<h4>"typing" via schema</h4>
<p>
the best-understood way to solve this problem is to publish a 
<a href="http://www.w3.org/TR/wsdl#_wsdl" title="WSDL Document Example">detailed schema document</a>
that lists
arguments and interaction details. 
</p>
<pre class="code">
&lt;?xml version="1.0"?&gt;
&lt;definitions name="StockQuote"

targetNamespace="http://example.com/stockquote.wsdl"
          xmlns:tns="http://example.com/stockquote.wsdl"
          xmlns:xsd1="http://example.com/stockquote.xsd"
          xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
          xmlns="http://schemas.xmlsoap.org/wsdl/"&gt;

    &lt;types&gt;
       &lt;schema targetNamespace="http://example.com/stockquote.xsd"
              xmlns="http://www.w3.org/2000/10/XMLSchema"&gt;
           &lt;element name="TradePriceRequest"&gt;
              &lt;complexType&gt;
                  &lt;all&gt;
                      &lt;element name="tickerSymbol" type="string"/&gt;
                  &lt;/all&gt;
              &lt;/complexType&gt;
           &lt;/element&gt;
.....
</pre>
<p>
this is the way 
<a href="http://www.w3.org/TR/soap/" title="SOAP Version 1.2">SOAP</a>
was designed to work, but shared schema is used in other environments, too.
the advantage of this approach is that it provides clear description for all parties. 
</p>
<p>
the downsides is that it most often is used as a way to express the details of private objects (almost
always on the server). when these objects change, all previously deployed clients can become broken
and must be rebuilt using the newly-published schema document. i've heard people say this "compile-time"
binding is not a requirement of the SOAP model, but i've yet to find an example of this happening 
in a dynamic way that is scalable.
</p>
<h4>"typing" via URI</h4>
<p>
another common solution is to try to make the URI carry "type" information:
</p>
<pre class="code">
http://www.example.org/orders/123
</pre>
<p>
this is a 
<a href="http://charlesleifer.com/blog/using-class-based-views-effectively/" tile="Using class-based views effectively">popular</a>
solution since most frameworks can easily generate these URIs from metadata 
within the source code. it also makes things relatively easy for frameworks that use templating and other
processing based on the "type." 
</p>
<p>
of course the biggest bummer is that you loose control of your public URI space. now private source code
decides what your URIs look like and any change to source code threatens to invalidate previously published
(and possibly cached) URIs.
</p>
<h4>"typing" via payload</h4>
<p>
if you want to keep in control of your URIs, you can opt for the second-most common option i see: 
<a href="http://msdn.microsoft.com/en-us/library/bb412170.aspx" title="Stand-Alone JSON Serialization">decorating the payload</a>. 
this is usually done by adding a "type" element to the JSON or XML body
or, in rare cases, adding a &lt;meta&gt; tag or @profile attribute to (X)HTML documents.
</p>
<pre class="code">
	{"__type":"Circle:#MyApp.Shapes","x":50,"y":70,"radius":10}
</pre>
<p>
i see this quite a bit in cases where JSON is used at the data format for payloads. 
it has the distinct advantage of allowing frameworks to "sniff" the contents of the payload to find the 
"type hint" and process the data accordingly.
</p>
<p>
the primary drawback of this method is that the payload is now tightly bound to source code. and, again,
changes to the source code on the server will modify response payloads and invalidate incoming request 
payloads from clients who have no idea the server has changed the details of the "typed" object.
</p>
<h4>"typing" via media type</h4>
<p>
the other 
<a href="http://www.devx.com/Java/Article/42873/1763/page/4" title="MIME Types Supported by JAX-RS for Request and Response">common solution</a>
i see is to create a custom public media type for each private object on the 
server.
</p>
<pre class="code">
....
...
@PUT
@Consumes("application/stockquote+xml")
public void createStock(Stock stock ) {
......
}
........
@Provider
@Produces("application/stockquote+xml")
public class StockProvider implements MessageBodyWriter&lt;Stock&gt; {
.....
</pre>
<p>
the advantage here is that you have full control over both the public URI and the payload (although
most frameworks link a private class to these custom media types). 
</p>
<p>
the downfall of this approach is that it merely pushes the problem along; in this scenario a single
application could generate dozens of new media types. it would be an incredible feat for an 
independent client application to try to keep up with recognizing and parsing the thousands of
media types that might be produced in a single year.
</p>
<h4>but the real problem is...</h4>
<p>
by now you should see a pattern. all these attempts are focused on the same thing:
</p>
<blockquote>
	"How can a server successfully export it's private objects in a way that clients can see and use them?"
</blockquote>
<p>
you might think that this is the correct question to ask, but you'd be mistaken. a better question is:
</p>
<blockquote>
  "How can a server and client share a common understanding of the payloads passed between them?"
</blockquote>
<p>
and the first answer is to stop trying to export private information out onto the public network.
</p>
<h4>so what's the answer?</h4>
<p>
instead of being stuck on the notion of shared objects, distributed network clients and servers need
to focus on shared understanding; a vocabulary or 
<a href="http://en.wikipedia.org/wiki/Ontology_%28information_science%29" title="Ontology (information science)">ontology</a>. 
</p>
<p>currently, for
HTTP-based applications the best way to provide a shared understanding is through well-defined 
<a href="http://www.iana.org/assignments/media-types/index.html" title="IANA MIME Media Types">media types</a>. 
and a media type SHOULD NOT be bound to any private objects; it SHOULD NOT rely on any
pre-determined URI patterns. instead, the media type should encapsulate the domain for which the 
client and server are communicating; it should be able to express the appropriate application-level 
semantics needed to accomplish the domain's tasks and describe the results.
</p>
<p>
i, personally, prefer using and designing 
<a href="http://www.amundsen.com/hypermedia/" title="Hypermedia Types">Hypermedia Types</a>. they offer
the possibility of expressing not only the 
<a href="../../hypermedia/profiles/index.html" title="ALPS - Application-Level Profile Semantics">domain-specific</a> 
details of shared understanding, but also the protocol-level elements (through a set of  
<a href="../../hypermedia/hfactor.html" title="H Factor">H-Factors</a>.)
</p>
<h4>oh yeah, Maslow's hammer...</h4>
<blockquote>
i bet you wondered when i'd get around to the Maslow thing...
</blockquote>
<p>
while the notion of using hypermedia-rich media types that also express application-domain details is 
appealing to many, the road to this apparent nivrana is not yet well-paved nor well-travelled.
most frameworks are tuned to serializing private objects out to the public network using one or
more of the methods i mentioned here. i know of very few frameworks that have avoided the 'object pit'
(<a href="http://webmachine.basho.com/" title="Webmachine">WebMachine</a> being one of them).
</p>
<p>
so, it's understandable that developers are likely to ask how to handle private object serialization and
sharing; they simply haven't found many alternatives. developers can become quite attached to their
'tools' (editors, frameworks, programming languages, etc.) and, as Maslow observed in 1966, 
in cases where those tools are 
<a href="http://en.wikipedia.org/wiki/Law_of_the_instrument" title="Law of the instrument">not quite
	adequate for the job</a> 
at hand, it is tough to drop your hammer and reach for another, possibly unfamiliar, instrument.
</p>
<p>
but that is exactly what i am urging you to do when you work on distributed network implementations
like HTTP over the Web.</p>
<h4>stop.</h4>
<h4>step back.</h4>
<h4>drop the hammer of object serialization.</h4>
<h4>and try picking up the tool of hypermedia types instead.</h4>
<p>
it just might be more suited to the job.
</p></div>
          <p class="category"><a href="index.html%3Fcategory=20.html" title="more from Hypermedia...">Hypermedia</a></p>
          <hr><a id="comments"></a><script>
						var idcomments_acct = 'b941b488f39712a0d6409992a0d7fc47';
						var idcomments_post_id;
						var idcomments_post_url;
					</script><span id="IDCommentsPostTitle" style="display:none"></span><script type="text/javascript" src="http://www.intensedebate.com/js/genericCommentWrapperV2.js"></script></div>
        <div> </div>
      </div>
      <div id="sidebar">
        <h4>categories</h4>
        <ul>
          <li><a href="index.html%3Fcategory=33.html">Systems</a></li>
          <li><a href="index.html%3Fcategory=32.html">CA</a></li>
          <li><a href="index.html%3Fcategory=31.html">IoT</a></li>
          <li><a href="index.html%3Fcategory=30.html">ALPS</a></li>
          <li><a href="index.html%3Fcategory=29.html">API</a></li>
          <li>[<a href="../categories/index.html%3Fall.html" title="view all categories">all</a>]</li>
        </ul>
        <h4>websites</h4>
        <ul>
          <li><a href="../websites/32.html">Untangled</a></li>
          <li><a href="../websites/31.html">Anne’s Weblog</a></li>
          <li><a href="../websites/30.html">exyus</a></li>
          <li><a href="../websites/29.html">Random Stuff</a></li>
          <li><a href="../websites/28.html">JScript Blog</a></li>
          <li>[<a href="../websites/index.html%3Fall.html" title="view all websites">all</a>]</li>
        </ul>
        <h4>archives</h4>
        <ul>
          <li><a href="index.html%3Ftoday.html" title="today's posts">today</a></li>
          <li><a href="index.html%3Fyesterday.html" title="yesterday's posts">yesterday</a></li>
          <li><a href="index.html%3Fthisweek.html" title="this weeks's posts">this week</a></li>
          <li><a href="index.html%3Flastweek.html" title="last week's posts">last week</a></li>
          <li><a href="index.html%3Fthismonth.html" title="this month's posts">this month</a></li>
          <li><a href="index.html%3Flastmonth.html" title="last month's posts">last month</a></li>
          <li>
								[<a href="index.html" title="browse the archives">browse</a>]
							</li>
        </ul>
        <div> </div>
        <div><xscript type="text/javascript" src="http://plancast.com/goodies/widgets/sidebar/1/15731">// plancast</xscript></div>
        <div id="twitter_div">
          <h4>my tweets</h4>
          <ul id="twitter_update_list"></ul>
          <div class="twitter-link"><a href="http://twitter.com/mamund" title="follow me on Twitter">
									follow me
								</a></div>
          <hr class="empty">
        </div>
      </div>
      <div id="ads" style="text-align:center;"><script type="text/javascript">
							google_ad_client = "pub-2944238157647009";
							google_ad_width = 728;
							google_ad_height = 90;
							google_ad_format = "728x90_as";
							google_ad_type = "text";
							//2007-08-10: amundsen.com
							google_ad_channel = "2960096544";
							google_color_border = "000000";
							google_color_bg = "F0F0F0";
							google_color_link = "000000";
							google_color_text = "000000";
							google_color_url = "000000";
						</script><script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script></div>
      <div id="footer">
        <p>Copyright © 2007-2010 amundsen.com, inc. All rights reserved.</p>
      </div>
    </div><script type="text/javascript" src="http://twitter.com/javascripts/blogger.js"></script><script type="text/javascript" src="http://twitter.com/statuses/user_timeline/mamund.json?callback=twitterCallback2&amp;count=5"></script><script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
					_uacct = "UA-2399548-1";
					urchinTracker();
				</script></body>
</html>