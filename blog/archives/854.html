<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head profile="http://purl.org/NET/erdf/profile">
    <META http-equiv="Content-Type" content="text/html; charset=utf-16">
    <title>
					mca blog
					
									[extreme late binding and loose coupling]
								</title>
    <link rel="alternate" type="application/x-wiki" title="Edit this blog" href="http://amundsen.com/blog/edit/">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for mca blog" href="../feed/index.html">
    <link rel="stylesheet" type="text/css" href="http://amundsen.com/server/conflate/?/xcs/blogging/css/blogging.css,/xcs/blogging/css/blogging-layout.css,/xcs/blogging/css/blogging-iran-election.css">
    <link rel="search" type="application/opensearchdescription+xml" title="MikeAmundsen and friends" href="http://wego-wego.appspot.com/friendfeed/mamund/osd/">
    <link rel="schema.rdfs" href="http://www.w3.org/2000/01/rdf-schema#">
    <link rel="schema.dc" href="http://purl.org/dc/elements/1.1/">
    <link rel="schema.foaf" href="http://xmlns.com/foaf/0.1/">
    <link rel="schema.bio" href="http://vocab.org/bio/0.1/">
    <link rel="schema.contact" href="http://www.w3.org/2000/10/swap/pim/contact#">
    <link rel="schema.air" href="http://www.daml.org/2001/10/html/airport-ont#">
    <link rel="schema.wn" href="http://xmlns.com/wordnet/1.6/">
    <link rel="schema.rss" href="http://purl.org/rss/1.0/">
    <link rel="schema.terms" href="http://purl.org/dc/terms/">
    <link rel="schema.rel" href="http://purl.org/vocab/relationship/">
    <link rel="schema.geo" href="http://www.w3.org/2003/01/geo/wgs84_pos#">
    <link rel="schema.aff" href="http://purl.org/vocab/affiliations/0.1/">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <link rel="schema.org" href="http://purl.org/vocab/organizations/0.1/">
    <link rel="schema.psych" href="http://purl.org/vocab/psychometric-profile/">
    <link rel="schema.doap" href="http://usefulinc.com/ns/doap#">
    <style type="text/css">
					form
					{
					font-size:small;
					padding:.3em;
					text-align:center;
					}
					input
					{
					font-size:x-small;
					}
					#twitter_div
					{
					/*
					width:95%
					padding:.2em;
					border:1px solid black;
					*/
					}
					#twitter_div h2
					{
					margin:0;
					padding:0;
					float:right;
					}
					.twitter-title
					{

					}
					#twitter_update_list
					{
					font-family:monospace;
					list-style:none;
					margin:0;
					padding:0;
					float:none;
					clear:both;
					}
					#twitter_update_list li
					{
					border:1px solid silver;
					background-color:#e6e6e6;
					margin:.2em .2em;
					}
					.twitter-link
					{
					display:block;
					float:right;
					margin-right: .7em;
					}
					#twitter_div a
					{
					text-decoration:none;
					}
					#twitter_div a:hover
					{
					text-decoration:underline;
					}
					.empty
					{
					float:none;
					clear:both;
					visibility:hidden;
					margin:0;
					padding:0;
					}
				</style><script type="text/javascript" src="http://amundsen.com/server/conflate/?/xcs/blogging/scripts/blogging.js,/lib/jscap/jcap.js,/lib/jscap/md5.js">//</script></head>
  <body>
    <div id="wrap">
      <div id="header">
        <h1><a href="../index.html" title="home page">mca blog</a></h1>
        <p class="title-desc">life in lowercase</p>
      </div>
      <div id="nav">
        <ul>
          <li><a href="../index.html" title="home page">Home</a></li>
          <li><a href="../categories/index.html" title="blog categories">Categories</a></li>
          <li><a href="../websites/index.html" title="intersting web sites">Web Sites</a></li>
          <li><a href="index.html" title="browse the archives">Archives</a></li>
        </ul>
      </div>
      <div id="main">
        <h2 class="dc-title">extreme late binding and loose coupling</h2>
        <div class="weblog">
          <div class="wb-header"><span class="foaf-maker" style="display:none;"><a href="http://www.amundsen.com/blog/author/mamund" title="Posted by mamund">mamund</a></span><span class="logdate" style="margin-left:1em;">2008-09-23 @ 21:32</span><span class="permalink"><a href="854.html" title="perma-link">#</a></span></div>
          <div class="dc-description"><p>when building a scale-able web app it's important to keep any binding between data storage and ultimate output loosely coupled. i see lots of examples of applications that define a data object (<code>Customer</code>) along with a set of properties (<code>Id, Name, Address</code>, etc.) and then work up code that can 'auto-magically' serialize that object into some desired output format (<code>XML, Atom, JSON</code>, etc.). there are a number of problems with this approach.</p>

<p>first, any changes in the underlying object require a rebuild of the app. that means not just changing the data type of an element, but adding a new one; removing an old one; renaming it; turing it from a simple value to a collection, etc. granted some of these changes might require compiling anyway, but other might not. this is especially true if you want to support multiple versions of the app over time. it's not nice to force every client to accept the new object even if they just want to stick w/ trusty version 1.0 of your app.</p>

<p>second, developers loose control over the serialization of the object. it's all done 'under the covers.' and even when some frameworks allow for customizing the serialization, it's usually pretty limited. for example, i have yet to see any serializer turn an <code>Address</code> into valid <code>(X)HTML</code>.</p>
<p>third, even if you have a successful serializer library, what if some users need an element named 'Customer' and others need that same element with the name 'Item'? what if some don't want to see certain elements at all? you're stuck building new objects and creating pathways to support these various requests. more code. more breakage.</p>
<p>instead, it's better to create an environment where it's easy to accept requests and produce responses tuned exactly to customers (or your own) needs. i prefer an XML pipeline approach. in the framework i've been using for close to a year now, all requests are treated to a series of XML/XSL/XSD steps that finally results in real work and output.</p>
<p>for example, below is a generic <code>GET</code> implementation for data stored in an SQL database. note the steps: 1) transform the arguments; 2) validate the arguments; 3) transform the validated arguments into valid T-SQL command(s); transform the results of the T-SQL into a valid representation (based on the requested content-type). this pattern works for any data stored in relational database. it works for any set of incoming arguments. it works for any supported representation format. it just works.</p>
<pre class="code">
// deliver from cache, if available
if (ch.CachedResourceIsValid((HTTPResource)this))
{
  return;
}

// transform argument list
xsl_file = (File.Exists(XslGetArgs) ? XslGetArgs : string.Empty);
if (File.Exists(xsl_file))
{
  xslt = new XslTransformer();
  out_text = xslt.ExecuteText(xmlin, xsl_file, ArgumentList);
  xmlin.LoadXml(out_text);
}
else
{
  xmlin.LoadXml("<args />");
}

// validate args before continuing
xsd_file = string.Empty;
xsd_file = (XsdFileMtype != string.Empty ? XsdFileMtype : XsdFile);
if (File.Exists(xsd_file))
{
  SchemaValidator sv = new SchemaValidator();
  string sch_error = sv.Execute(xmlin, xsd_file);
  if (sch_error != string.Empty)
  {
    throw new HttpException(400, sch_error);
  }
}

// transform args into sql and execute
xsl_file = (File.Exists(xslGetRequestContentType) ? xslGetRequestContentType : string.Empty);
if (File.Exists(xsl_file))
{
  xslt = new XslTransformer();
  string cmdtext = xslt.ExecuteText(xmlin, xsl_file, ArgumentList);

  // execute sql and return results
  SqlXmlCommand cmd = new SqlXmlCommand(util.GetConfigSectionItem(Constants.cfg_exyusSettings, this.ConnectionString));
  cmd.CommandText = cmdtext;

  using (XmlReader rdr = cmd.ExecuteXmlReader())
  {
      xmlout.Load(rdr);
      rdr.Close();
  }

  // transform outputs into representation
  xsl_file = (File.Exists(xslGetResponseContentType) ? xslGetResponseContentType : string.Empty);
  if (File.Exists(xsl_file))
  {
      xslt = new XslTransformer();
      out_text = xslt.ExecuteText(xmlout, xsl_file, ArgumentList);
  }
  else
  {
      out_text = util.FixEncoding(xmlout.OuterXml);
  }

  // handle caching of this resource
  ch.CacheResource((HTTPResource)this,out_text);

  // return the results
  this.Response = out_text;
}
else
{
  throw new HttpException(500, "missing sql transform");
}
</pre>

</div>
          <p class="category"><a href="index.html%3Fcategory=5.html" title="more from code...">code</a></p>
          <hr><a id="comments"></a><script>
						var idcomments_acct = 'b941b488f39712a0d6409992a0d7fc47';
						var idcomments_post_id;
						var idcomments_post_url;
					</script><span id="IDCommentsPostTitle" style="display:none"></span><script type="text/javascript" src="http://www.intensedebate.com/js/genericCommentWrapperV2.js"></script></div>
        <div> </div>
      </div>
      <div id="sidebar">
        <h4>categories</h4>
        <ul>
          <li><a href="index.html%3Fcategory=33.html">Systems</a></li>
          <li><a href="index.html%3Fcategory=32.html">CA</a></li>
          <li><a href="index.html%3Fcategory=31.html">IoT</a></li>
          <li><a href="index.html%3Fcategory=30.html">ALPS</a></li>
          <li><a href="index.html%3Fcategory=29.html">API</a></li>
          <li>[<a href="../categories/index.html%3Fall.html" title="view all categories">all</a>]</li>
        </ul>
        <h4>websites</h4>
        <ul>
          <li><a href="../websites/32.html">Untangled</a></li>
          <li><a href="../websites/31.html">Anne’s Weblog</a></li>
          <li><a href="../websites/30.html">exyus</a></li>
          <li><a href="../websites/29.html">Random Stuff</a></li>
          <li><a href="../websites/28.html">JScript Blog</a></li>
          <li>[<a href="../websites/index.html%3Fall.html" title="view all websites">all</a>]</li>
        </ul>
        <h4>archives</h4>
        <ul>
          <li><a href="index.html%3Ftoday.html" title="today's posts">today</a></li>
          <li><a href="index.html%3Fyesterday.html" title="yesterday's posts">yesterday</a></li>
          <li><a href="index.html%3Fthisweek.html" title="this weeks's posts">this week</a></li>
          <li><a href="index.html%3Flastweek.html" title="last week's posts">last week</a></li>
          <li><a href="index.html%3Fthismonth.html" title="this month's posts">this month</a></li>
          <li><a href="index.html%3Flastmonth.html" title="last month's posts">last month</a></li>
          <li>
								[<a href="index.html" title="browse the archives">browse</a>]
							</li>
        </ul>
        <div> </div>
        <div><xscript type="text/javascript" src="http://plancast.com/goodies/widgets/sidebar/1/15731">// plancast</xscript></div>
        <div id="twitter_div">
          <h4>my tweets</h4>
          <ul id="twitter_update_list"></ul>
          <div class="twitter-link"><a href="http://twitter.com/mamund" title="follow me on Twitter">
									follow me
								</a></div>
          <hr class="empty">
        </div>
      </div>
      <div id="ads" style="text-align:center;"><script type="text/javascript">
							google_ad_client = "pub-2944238157647009";
							google_ad_width = 728;
							google_ad_height = 90;
							google_ad_format = "728x90_as";
							google_ad_type = "text";
							//2007-08-10: amundsen.com
							google_ad_channel = "2960096544";
							google_color_border = "000000";
							google_color_bg = "F0F0F0";
							google_color_link = "000000";
							google_color_text = "000000";
							google_color_url = "000000";
						</script><script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script></div>
      <div id="footer">
        <p>Copyright © 2007-2010 amundsen.com, inc. All rights reserved.</p>
      </div>
    </div><script type="text/javascript" src="http://twitter.com/javascripts/blogger.js"></script><script type="text/javascript" src="http://twitter.com/statuses/user_timeline/mamund.json?callback=twitterCallback2&amp;count=5"></script><script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
					_uacct = "UA-2399548-1";
					urchinTracker();
				</script></body>
</html>